<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PJ Store</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body{
margin:0;
font-family:Poppins;
background:#0f0f0f;
color:white;
}

header{
display:flex;
justify-content:space-between;
align-items:center;
padding:15px;
background:#111;
position:sticky;
top:0;
z-index:10;
box-shadow:0 2px 10px #000;
}

.logo{
font-size:22px;
font-weight:700;
color:#ff7a00;
}

.cart-btn{
background:#ff7a00;
border:none;
padding:10px 15px;
border-radius:8px;
cursor:pointer;
font-weight:bold;
}

.products{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
gap:20px;
padding:20px;
}

.card{
background:#1a1a1a;
padding:15px;
border-radius:15px;
text-align:center;
transition:.3s;
}
.card:hover{
transform:translateY(-5px);
}

.price{
color:#ffb347;
font-weight:bold;
margin:10px 0;
}

button{
cursor:pointer;
border:none;
border-radius:8px;
padding:10px 15px;
font-weight:bold;
}

.add{
background:#ff7a00;
color:white;
}

.cart{
position:fixed;
right:-400px;
top:0;
width:320px;
height:100%;
background:#121212;
padding:15px;
transition:.4s;
overflow:auto;
z-index:20;
box-shadow:-5px 0 20px #000;
}

.cart.active{
right:0;
}

.cart h2{
margin-top:0;
}

.item{
background:#1f1f1f;
padding:10px;
border-radius:10px;
margin:10px 0;
}

.qty{
display:flex;
justify-content:center;
gap:10px;
margin-top:8px;
}

.qty button{
background:#ff7a00;
color:white;
width:30px;
height:30px;
}

.remove{
background:red;
margin-top:8px;
}

.checkout{
width:100%;
background:#00c853;
margin-top:15px;
}
</style>
</head>
<body>

<header>
<div class="logo">PJ Flute Store</div>
<button class="cart-btn" onclick="toggleCart()">Cart üõí (<span id="count">0</span>)</button>
</header>

<!-- PRODUCTS -->
<div class="products" id="products"></div>

<!-- CART -->
<div class="cart" id="cart">
<h2>Your Cart</h2>
<div id="cartItems"></div>
<h3 id="total"></h3>
<button class="checkout" onclick="checkout()">Order on WhatsApp</button>
</div>

<script>
const products=[
{name:"E Middle Flute",price:1100,weight:200},
{name:"D Middle Flute",price:1300,weight:220},
{name:"A# Base Flute",price:1200,weight:250},
{name:"C Sharp Flute",price:1500,weight:270}
];

let cart=[];
let userCountry="Unknown";
let userPlace="Unknown";


// LOCATION DETECT
navigator.geolocation.getCurrentPosition(pos=>{
fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${pos.coords.latitude}&lon=${pos.coords.longitude}`)
.then(r=>r.json())
.then(d=>{
userCountry=d.address.country||"Unknown";
userPlace=d.address.city||d.address.state||"Unknown";
});
});


// RENDER PRODUCTS
const container=document.getElementById("products");
products.forEach((p,i)=>{
container.innerHTML+=`
<div class="card">
<h3>${p.name}</h3>
<div class="price">‚Çπ${p.price}</div>
<button class="add" onclick="addCart(${i})">Add to Cart</button>
</div>`;
});


// CART FUNCTIONS
function addCart(i){
let item=cart.find(x=>x.id==i);
if(item) item.qty++;
else cart.push({id:i,qty:1});
renderCart();
}

function changeQty(i,amt){
cart[i].qty+=amt;
if(cart[i].qty<=0) cart.splice(i,1);
renderCart();
}

function removeItem(i){
cart.splice(i,1);
renderCart();
}

function renderCart(){
let html="";
let total=0;
let count=0;

cart.forEach((c,i)=>{
let p=products[c.id];
let sub=p.price*c.qty;

total+=sub;
count+=c.qty;

html+=`
<div class="item">
<b>${p.name}</b><br>
‚Çπ${p.price} √ó ${c.qty} = ‚Çπ${sub}
<div class="qty">
<button onclick="changeQty(${i},-1)">‚àí</button>
<button onclick="changeQty(${i},1)">+</button>
</div>
<button class="remove" onclick="removeItem(${i})">Remove</button>
</div>`;
});

document.getElementById("cartItems").innerHTML=html;
document.getElementById("total").innerText="Total ‚Çπ"+total;
document.getElementById("count").innerText=count;
}

function toggleCart(){
document.getElementById("cart").classList.toggle("active");
}


// DELIVERY CALCULATOR
function deliveryCharge(){
if(userCountry.toLowerCase().includes("india")) return 100;
return 300;
}


// CHECKOUT MESSAGE
function checkout(){

if(cart.length==0){alert("Cart Empty");return;}

let msg="Order Details:%0A";
let total=0;
let items=0;

cart.forEach(c=>{
let p=products[c.id];
let sub=p.price*c.qty;

msg+=`${p.name} ‚Çπ${p.price} x${c.qty} = ‚Çπ${sub}%0A`;
total+=sub;
items+=c.qty;
});

let delivery=deliveryCharge();

msg+=`%0Aüì¶ Total Items = ${items}`;
msg+=`%0Aüåç Location: ${userPlace}, ${userCountry}`;
msg+=`%0Aüöö Delivery Charge = ‚Çπ${delivery}`;
msg+=`%0Aüí∞ Total Price = ‚Çπ${total+delivery}`;

window.open(`https://wa.me/?text=${msg}`);
}
</script>

</body>
</html>
