<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PJ Store | Professional Flutes</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
    --primary: #ff7a00;
    --accent: #ffe7b0;
    --dark: #000000;
}

body {
    margin: 0;
    background: var(--dark);
    color: var(--accent);
    font-family: 'Poppins', sans-serif;
    overflow-x: hidden;
    -webkit-tap-highlight-color: transparent;
}

button, a, input, div, span {
    outline: none;
}

.hidden { display: none !important; }

/* WATERMARK BACKGROUND */
.watermark-bg {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80vw;
    height: 80vw;
    max-width: 600px;
    max-height: 600px;
    background: url('https://i.postimg.cc/3w76Yfc0/file-00000000f0cc71faab033f0116f53261.jpg') no-repeat center;
    background-size: contain;
    opacity: 0.1;
    z-index: -1;
    pointer-events: none;
}

/* TOP NAVIGATION */
.top {
    position: fixed;
    top: 0;
    width: 100%;
    height: 70px;
    background: var(--primary);
    display: flex;
    align-items: center;
    padding: 0 20px;
    z-index: 999;
    box-sizing: border-box;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.logo { width: 45px; height: 45px; border-radius: 50%; border: 2px solid white; }
.logoBox { display: flex; align-items: center; gap: 12px; }
.logoBox span { font-size: 16px; font-weight: bold; color: white; letter-spacing: 1px; }

.nav-right {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 15px;
}

.cartIcon {
    display: flex;
    align-items: center;
    cursor: pointer;
    color: white;
}

.ytIcon {
    width: 32px;
    height: 32px;
    cursor: pointer;
    display: block;
}

/* CONTENT */
.content-wrapper { padding-top: 80px; }

.title { 
    text-align: center; 
    font-size: 65px; 
    font-family: 'Great Vibes', cursive; 
    margin: 20px 0 10px;
    color: var(--primary);
}

.heroTitle {
    text-align: center;
    font-size: 32px;
    font-family: "Great Vibes";
    margin-bottom: 20px;
}

/* PREMIUM FADE SLIDER */
.slider-container {
    width: 90%;
    margin: 20px auto;
    height: 250px;
    position: relative;
    border-radius: 25px;
    overflow: hidden;
    box-shadow: 0 15px 35px rgba(0,0,0,0.6);
    border: 1px solid rgba(255,122,0,0.3);
}

.slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 1.5s ease-in-out;
    background-size: cover;
    background-position: center;
}

.slide.active { opacity: 1; }

.slide::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 50%;
    background: linear-gradient(transparent, rgba(0,0,0,0.8));
}

/* 3D BUTTON */
.shopBtn {
    display: block;
    margin: 35px auto;
    background: linear-gradient(to bottom, #ff9a2f, #ff7a00);
    color: white;
    border: none;
    padding: 18px 50px;
    border-radius: 40px;
    font-size: 22px;
    font-weight: bold;
    text-transform: uppercase;
    box-shadow: 0 8px 0 #c45c00, 0 15px 20px rgba(0,0,0,0.4);
    cursor: pointer;
    transition: all 0.1s;
}

.shopBtn:active {
    transform: translateY(6px);
    box-shadow: 0 2px 0 #c45c00;
}

/* SECTION STYLING */
.info-section {
    width: 90%;
    margin: 30px auto;
    background: rgba(255,122,0,0.05);
    padding: 25px;
    border-radius: 25px;
    border: 1px solid rgba(255,122,0,0.2);
}

.info-section h2 {
    color: var(--primary);
    font-family: 'Great Vibes', cursive;
    font-size: 36px;
    text-align: center;
    margin-bottom: 20px;
}

.info-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.info-list li {
    font-size: 14px;
    margin-bottom: 12px;
    padding-left: 25px;
    position: relative;
    line-height: 1.6;
}

.info-list li::before {
    content: "•";
    color: var(--primary);
    position: absolute;
    left: 0;
    font-weight: bold;
    font-size: 20px;
}

/* CONTACT BUTTONS */
.contact-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    margin: 30px 10px;
}

.btn-contact {
    background: var(--primary);
    color: white;
    padding: 12px 10px;
    border-radius: 30px;
    text-decoration: none;
    font-weight: 600;
    flex: 1;
    text-align: center;
    font-size: 13px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    white-space: nowrap;
}

/* FOOTER */
.footer { text-align: center; padding: 40px 0; opacity: 0.7; font-size: 14px; }

/* OVERLAYS */
#shop, #cartPage {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: var(--dark); overflow-y: auto; padding: 90px 20px 100px;
    z-index: 10000; box-sizing: border-box;
}

.header { 
    position: fixed; top: 0; left: 0; width: 100%;
    background: #111; padding: 15px 20px; 
    display: flex; justify-content: space-between; align-items: center;
    border-bottom: 1px solid #333; z-index: 10001;
    box-sizing: border-box;
}

.backIcon {
    cursor: pointer;
    display: flex;
    align-items: center;
}

.search { 
    width: calc(100% - 10px); 
    max-width: 500px; 
    margin: 10px auto 30px; 
    display: block;
    padding: 15px 20px; 
    border-radius: 30px; 
    border: 1px solid #444; 
    background: #222; 
    color: white; 
    outline: none;
    box-sizing: border-box;
}

.list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }

.product { background: #111; border-radius: 20px; padding: 20px; border: 1px solid #222; }
.product img { width: 100%; height: 250px; object-fit: cover; border-radius: 15px; margin-bottom: 15px; }

/* QUANTITY CONTROLS */
.qty-box {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin: 10px 0;
}
.qty-btn {
    background: #333;
    color: var(--primary);
    border: 1px solid var(--primary);
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
}
.qty-btn:active { background: var(--primary); color: white; }
.qty-num { font-weight: bold; font-size: 18px; min-width: 25px; text-align: center; color: white; }

.buy {
    background: var(--primary); border: none; padding: 14px; width: 100%;
    margin-top: 10px; border-radius: 12px; color: white; font-weight: bold;
    cursor: pointer; font-size: 16px; box-shadow: 0 4px 0 #b95600;
}

.buy-alt { background: transparent; border: 1px solid var(--primary); color: var(--primary); box-shadow: none; }

</style>
</head>
<body>

<div class="watermark-bg"></div>

<div class="top">
    <div class="logoBox">
        <img class="logo" src="https://i.postimg.cc/3w76Yfc0/file-00000000f0cc71faab033f0116f53261.jpg">
        <span>PJ STORE</span>
    </div>
    <div class="nav-right">
        <a href="https://www.youtube.com/@PJCompany-432" target="_blank">
            <svg class="ytIcon" viewBox="0 0 24 24">
                <path fill="#FF0000" d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"/>
                <path fill="#FFFFFF" d="M9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
        </a>
        <div class="cartIcon" onclick="openCart()">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <span id="cartCount" style="background:white; color:black; font-size:11px; border-radius:50%; width:18px; height:18px; display:inline-flex; align-items:center; justify-content:center; font-weight:bold; margin-left: -5px; margin-top: -15px; border: 2px solid var(--primary);">0</span>
        </div>
    </div>
</div>

<div id="home" class="content-wrapper">
    <div class="title">PJ Store</div>
    
    <div class="slider-container">
        <div class="slide active" style="background-image: url('https://i.postimg.cc/zXkJgfLD/IMG-20260218-194815-054.jpg');"></div>
        <div class="slide" style="background-image: url('https://i.postimg.cc/N0KYS7dg/IMG-20260218-194851-468-2.jpg');"></div>
    </div>

    <div class="heroTitle">PJ Classical Flute Shop</div>

    <button class="shopBtn" onclick="openShop()">Shop Now</button>

    <div style="width: 90%; margin: 20px auto; border-radius: 25px; overflow: hidden; border: 1px solid rgba(255,122,0,0.2);">
        <img src="https://i.postimg.cc/sg32c8SP/Screenshot-20260219-102520-Instagram.png" style="width:100%; display:block;">
    </div>

    <!-- WHY CHOOSE US -->
    <div class="info-section">
        <h2>Why Choose PJ Flutes</h2>
        <ul class="info-list">
            <li>Handcrafted with over 9 years of professional experience.</li>
            <li>Made from premium quality, seasoned Assam Bamboo.</li>
            <li>Each flute is manually tuned to perfection for stage performance.</li>
            <li>Durable binding and polished finish for long-lasting use.</li>
            <li>Direct support and consultation from the maker himself.</li>
        </ul>
    </div>

    <!-- CONTACT SECTION (LINED UP) -->
    <div class="contact-container">
        <a href="https://wa.me/919476091829" class="btn-contact">WhatsApp</a>
        <a href="tel:9434274060" class="btn-contact">Call Us</a>
        <a href="mailto:pjcompanyofficial@gmail.com" class="btn-contact">Email Us</a>
    </div>

    <div class="footer">© 2026 PJ Store. Handcrafted Perfection.</div>
</div>

<!-- SHOP OVERLAY -->
<div id="shop" class="hidden">
    <div class="header">
        <div class="backIcon" onclick="closeShop()">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        </div>
        <div style="font-weight:bold; color: white;">Our Collection</div>
        <div></div>
    </div>
    <input class="search" placeholder="Search by scale (e.g. C#)..." onkeyup="search(this.value)">
    <div class="list" id="list"></div>
</div>

<!-- CART OVERLAY -->
<div id="cartPage" class="hidden">
    <div class="header">
        <div class="backIcon" onclick="closeCart()">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        </div>
        <div style="font-weight:bold; color: white;">Your Cart</div>
        <div></div>
    </div>
    <div id="cartItems"></div>
    <div style="background:#111; padding:20px; border-radius:20px; margin-top:20px; text-align:center">
        <h2 style="color:white">Total: ₹ <span id="total">0</span></h2>
        <button class="shopBtn" onclick="sendOrder()">Confirm Order via WhatsApp</button>
    </div>
</div>

<!-- Firebase SDKs -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

// Global Setup
let currentUser = null;
let cart = [];
let app = null, auth = null, db = null;
const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

// SAFE INITIALIZATION
if (typeof __firebase_config !== "undefined" && __firebase_config) {
    try {
        const firebaseConfig = JSON.parse(__firebase_config);
        app = initializeApp(firebaseConfig);
        auth = getAuth(app);
        db = getFirestore(app);

        // Auth setup
        signInAnonymously(auth).catch(console.error);
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                const cartRef = doc(db, 'artifacts', appId, 'users', user.uid, 'store', 'cart');
                onSnapshot(cartRef, (docSnap) => {
                    if (docSnap.exists()) {
                        cart = docSnap.data().items || [];
                        updateCartIcon();
                        if (!document.getElementById("cartPage").classList.contains("hidden")) {
                            renderCart();
                        }
                    }
                }, (err) => console.log("Firestore sync error:", err));
            }
        });
    } catch(e) {
        console.warn("Firebase failed to init:", e);
    }
}

async function syncCart() {
    updateCartIcon();
    if (!currentUser || !db) return;
    const cartRef = doc(db, 'artifacts', appId, 'users', currentUser.uid, 'store', 'cart');
    await setDoc(cartRef, { items: cart });
}

// Global UI Quantities for Shop list
let shopQtys = {};

window.updateShopQty = (name, delta) => {
    if (!shopQtys[name]) shopQtys[name] = 1;
    shopQtys[name] = Math.max(1, shopQtys[name] + delta);
    const pId = name.replace(/\s+/g, '');
    const qtyEl = document.getElementById(`sqty-${pId}`);
    if(qtyEl) qtyEl.innerText = shopQtys[name];
};

window.addCart = (name) => {
    let p = products.find(x => x.name === name);
    let qtyToAdd = shopQtys[name] || 1;
    let item = cart.find(x => x.name === name);
    
    if(item) {
        item.qty += qtyToAdd;
    } else {
        cart.push({...p, qty: qtyToAdd});
    }
    
    shopQtys[name] = 1;
    const pId = name.replace(/\s+/g, '');
    const qtySpan = document.getElementById(`sqty-${pId}`);
    if(qtySpan) qtySpan.innerText = 1;
    
    syncCart();
};

window.removeItem = (i) => {
    cart.splice(i, 1);
    syncCart();
    renderCart();
};

// Slider Logic
let currentSlide = 0;
const slides = document.querySelectorAll('.slide');
setInterval(() => {
    if(slides.length > 0) {
        slides[currentSlide].classList.remove('active');
        currentSlide = (currentSlide + 1) % slides.length;
        slides[currentSlide].classList.add('active');
    }
}, 8000);

// Products
const products = [
    {name:"E Middle Flute", price:1100, size:"41cm", img:"https://i.postimg.cc/PJDKmt83/IMG-20260218-153859-964.webp"},
    {name:"D Middle Flute", price:1300, size:"45.5cm", img:"https://i.postimg.cc/02TxJJnR/Screenshot-20260218-203603-Google.png"},
    {name:"C# Middle Flute", price:1470, size:"46.3cm", img:"https://i.postimg.cc/QMrD5t9Y/Screenshot-20260218-154446-Google.jpg"},
    {name:"C Middle Flute", price:1500, size:"50cm", img:"https://i.postimg.cc/mZFGdCYd/Screenshot-20260218-154844-Google.png"},
    {name:"A# Base Flute", price:1200, size:"56.5cm", img:"https://i.postimg.cc/nVK3cLZy/Screenshot-20260218-155124-Google.png"},
    {name:"G# Base Flute", price:1200, size:"60cm", img:"https://i.postimg.cc/7YGbn56K/1771410309328.jpg"},
    {name:"G Base Flute", price:1800, size:"65.7cm", img:"https://i.postimg.cc/BnC8XdtD/Screenshot-20260218-155724-Google.png"}
];

function render(arr) {
    const shopList = document.getElementById("list");
    if(!shopList) return;
    shopList.innerHTML = "";
    arr.forEach(p => {
        const pId = p.name.replace(/\s+/g, '');
        const currentQty = shopQtys[p.name] || 1;
        shopList.innerHTML += `
        <div class="product">
            <img src="${p.img}">
            <h3 style="margin:0; color:var(--primary)">${p.name}</h3>
            <p style="font-size:13px; opacity:0.7">Size: ${p.size}</p>
            <div style="font-size:20px; font-weight:bold; margin:10px 0; color: white;">₹ ${p.price}</div>
            
            <div class="qty-box">
                <button class="qty-btn" onclick="updateShopQty('${p.name}', -1)">-</button>
                <span class="qty-num" id="sqty-${pId}">${currentQty}</span>
                <button class="qty-btn" onclick="updateShopQty('${p.name}', 1)">+</button>
            </div>

            <button class="buy buy-alt" onclick="addCart('${p.name}')">Add to Cart</button>
            <button class="buy" onclick="buyNow('${p.name}')">Buy Now</button>
        </div>`;
    });
};

window.openShop = () => { 
    document.getElementById("home").classList.add("hidden"); 
    document.getElementById("shop").classList.remove("hidden"); 
    render(products); 
};
window.closeShop = () => { 
    document.getElementById("shop").classList.add("hidden"); 
    document.getElementById("home").classList.remove("hidden"); 
};
window.openCart = () => { 
    document.getElementById("cartPage").classList.remove("hidden"); 
    renderCart(); 
};
window.closeCart = () => { 
    document.getElementById("cartPage").classList.add("hidden"); 
};

window.search = (v) => { 
    render(products.filter(p => p.name.toLowerCase().includes(v.toLowerCase()))); 
};

function updateCartIcon() { 
    document.getElementById("cartCount").innerText = cart.reduce((t, i) => t + i.qty, 0); 
}

window.buyNow = (name) => {
    let p = products.find(x => x.name === name);
    let q = shopQtys[name] || 1;
    let msg = `Hello PJ Store! I want to buy:\nProduct: ${p.name}\nQuantity: ${q}\nTotal: ₹ ${p.price * q}`;
    window.open("https://wa.me/919476091829?text=" + encodeURIComponent(msg), "_blank");
};

function renderCart() {
    const cartDiv = document.getElementById("cartItems");
    if(!cartDiv) return;
    let total = 0;
    cartDiv.innerHTML = cart.length ? "" : '<div style="text-align:center; padding:50px; opacity:0.5; color: white;">Your cart is empty</div>';
    cart.forEach((p, i) => {
        total += p.price * p.qty;
        cartDiv.innerHTML += `
        <div class="product" style="margin-bottom:15px; display:flex; gap:15px; align-items:center;">
            <img src="${p.img}" style="width:60px; height:60px; object-fit:cover; border-radius:10px;">
            <div style="flex-grow:1">
                <h4 style="margin:0; color: white;">${p.name}</h4>
                <div style="color:var(--primary)">₹ ${p.price} x ${p.qty}</div>
            </div>
            <span style="color:red; cursor:pointer; font-weight: bold; font-size: 18px;" onclick="removeItem(${i})">✕</span>
        </div>`;
    });
    const totalEl = document.getElementById("total");
    if(totalEl) totalEl.innerText = total;
}

window.sendOrder = () => {
    if(!cart.length) return;
    let msg = "New Order from PJ Store App:\n";
    cart.forEach(p => msg += `- ${p.name} (x${p.qty})\n`);
    msg += `Total: ₹ ${document.getElementById("total").innerText}`;
    window.open("https://wa.me/919476091829?text=" + encodeURIComponent(msg), "_blank");
};

// Expose these for HTML click events
window.openShop = window.openShop;
window.closeShop = window.closeShop;
window.openCart = window.openCart;
window.closeCart = window.closeCart;
window.search = window.search;

</script>

</body>
</html>

