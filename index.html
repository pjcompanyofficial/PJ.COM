<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PJ Shopping Web</title>
<style>
body, html { margin:0; padding:0; font-family: Arial, sans-serif; width:100%; height:100%; background:#ffe5f0; overflow:hidden; perspective:1200px;}
#background {position:fixed; top:0; left:0; width:100%; height:100%; z-index:-2; overflow:hidden;}
.pattern{position:absolute; width:100px; height:100px; border-radius:50%; opacity:0.7; background: radial-gradient(circle at 30% 30%, #ff0080, #ffdf00);}
.bubble{position:absolute; bottom:-50px; width:20px; height:20px; background: rgba(255,255,255,0.5); border-radius:50%; animation: rise linear infinite;}
@keyframes rise{0%{transform:translateY(0) scale(0.5); opacity:0.6;}100%{transform:translateY(-110vh) scale(1); opacity:0;}}
.top-title{position:absolute; top:20px; width:100%; text-align:center; font-size:60px; font-weight:bold; background:linear-gradient(to top, yellow, orange, red); -webkit-background-clip:text; color:transparent; animation: gradientAnim 4s infinite;}
@keyframes gradientAnim{0%{background-position:0 0;}50%{background-position:0 100%;}100%{background-position:0 0;}}
.shop-section{position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; z-index:10;}
.shop-name{font-family:"Brush Script MT", cursive; font-size:36px; color:black; margin-bottom:10px;}
.shop-btn,.ai-btn{padding:20px 40px; margin:10px 0; border-radius:20px; font-weight:bold; font-size:18px; cursor:pointer; box-shadow:0 12px 25px rgba(0,0,0,0.5);}
.shop-btn{background:#ff8c00; color:white;}
.ai-btn{background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,0.3); color:black;}
.center-buttons{position:absolute; bottom:100px; left:50%; transform:translateX(-50%); display:flex; gap:15px; z-index:10;}
.center-btn{padding:15px 25px; border-radius:15px; font-weight:bold; font-size:14px; color:#000; background: rgba(255,255,255,0.15); backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,0.3); cursor:pointer; box-shadow:0 8px 20px rgba(0,0,0,0.3);}
.bottom-text{position:absolute; bottom:5px; width:100%; text-align:center; font-size:10px; color:#000;}
#topHeart{position:absolute; top:20px; right:30px; font-size:40px; color:#888; cursor:pointer; transition: color 0.3s;}
#topHeart.liked{color:red;}
.overlay{position:absolute; top:0; left:0; width:100%; height:100%; background: rgba(255,255,255,0.95); display:none; flex-direction:column; align-items:center; overflow-y:auto; padding:20px; z-index:15;}
.card{width:90%; max-width:400px; margin:30px auto; border-radius:12px; border:2px solid orange; box-shadow:0 4px 15px rgba(0,0,0,0.1); overflow:hidden;}
.card img{width:100%; display:block;}
.card-content{padding:12px;}
.card-title{font-weight:bold; font-size:16px; margin-bottom:5px;}
.card-price{font-weight:bold; color:#ff6600; margin-bottom:5px;}
.card-desc{font-size:13px; margin-bottom:8px;}
.card-actions{display:flex; gap:10px;}
.like-btn{font-size:20px; color:#888; cursor:pointer;}
.like-btn.liked{color:red;}
.order-btn{flex-grow:1; padding:6px 10px; border:none; border-radius:6px; background:#ffa500; color:#fff; font-weight:bold; cursor:pointer;}
.floating-heart{position:absolute; font-size:40px; color:red; pointer-events:none;}
.ai-overlay{position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.95); display:none; flex-direction:column;}
.ai-back{position:absolute; top:20px; left:20px; font-size:30px; cursor:pointer;}
.ai-chat{margin-top:70px; flex:1; padding:10px; overflow-y:auto;}
.ai-input-container{position:absolute; bottom:10px; left:50%; transform:translateX(-50%); display:flex; width:90%; max-width:500px; gap:10px;}
.ai-input-container input{flex:1; padding:10px; border-radius:10px; border:1px solid #ccc;}
.ai-input-container button{padding:10px 20px; border-radius:10px; background:#ff8c00; color:white; border:none; cursor:pointer;}
</style>
</head>
<body>

<div id="background"></div>
<div class="top-title">PJ Shopping Web</div>

<div class="shop-section">
    <div class="shop-name">PJ Classical Flutes Shop</div>
    <div class="shop-btn" onclick="openShop()">Shopping</div>
    <div class="ai-btn" onclick="openAI()">AI Chat</div>
</div>

<div id="topHeart">&#10084;</div>

<div class="center-buttons">
    <div class="center-btn" onclick="callNumber()">Call</div>
    <div class="center-btn" onclick="whatsappMessage()">WhatsApp</div>
    <div class="center-btn" onclick="openInstagram()">Instagram</div>
    <div class="center-btn" onclick="sendEmail()">Email</div>
</div>

<div class="bottom-text">PJ Official Website</div>

<div class="overlay" id="overlay">
    <div class="back-arrow" onclick="closeOverlay()">&#8592; Back</div>
    <h2 style="font-family:cursive;margin-top:30px;">Are you shopping field?</h2>
    <div id="overlay-content"></div>
</div>

<div class="ai-overlay" id="aiOverlay">
    <div class="ai-back" onclick="closeAI()">&#8592; Back</div>
    <div class="ai-chat" id="aiMessages"></div>
    <div class="ai-input-container">
        <input type="text" id="aiInput" placeholder="Type your question...">
        <button onclick="sendAIMessage()">Send</button>
    </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
/* Firebase Config */
const firebaseConfig = { /* your firebase config here */ };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* Products */
let posts=[
    {id:1,img:"https://i.postimg.cc/nhB6tbqH/Screenshot-20260218-002442-Whats-App-Business.png",name:"D middle Flute",price:450,desc:"Handcraft D middle flute perfect for flow",liked:false},
    {id:2,img:"https://i.postimg.cc/g2VBTyPP/Screenshot-20260218-002911-Whats-App-Business.png",name:"C middle Flute",price:1500,desc:"Flow with C middle Flute magical sound",liked:false}
];
let likedProducts=[];

/* Load likes from Firebase */
firebase.database().ref('likes').on('value', snapshot => {
    const data = snapshot.val() || {};
    likedProducts = [];
    posts.forEach(p => {
        if(data[p.id]) p.liked = true, likedProducts.push(p);
        else p.liked = false;
    });
    renderShop(posts);
});

/* Render Shop */
function renderShop(list){
    overlayContent.innerHTML="";
    if(list.length===0){
        overlayContent.innerHTML="<div style='margin:20px;color:#888;'>No products liked yet.</div>";
        return;
    }
    list.forEach(p=>{
        const card=document.createElement('div');
        card.className='card';
        card.id='post-'+p.id;
        card.innerHTML=`
            <img src="${p.img}" alt="Product"/>
            <div class="card-content">
                <div class="card-title">${p.name}</div>
                <div class="card-price">₹${p.price}</div>
                <div class="card-desc">${p.desc}</div>
                <div class="card-actions">
                    <span class="like-btn ${p.liked?'liked':''}" onclick="toggleLike(${p.id}, this)">&#10084;</span>
                    <button class="order-btn" onclick="sendOrder(${p.id})">Send Request</button>
                </div>
            </div>`;
        overlayContent.appendChild(card);
    });
}

/* Toggle Like with animation and Firebase */
function toggleLike(id, el){
    const product = posts.find(p=>p.id===id);
    product.liked = !product.liked;
    if(product.liked){
        likedProducts.push(product);
        firebase.database().ref('likes/'+id).set(true);

        // Heart animation
        const rect = el.getBoundingClientRect();
        const topHeart = document.getElementById('topHeart');
        const topRect = topHeart.getBoundingClientRect();
        const fh = document.createElement('div');
        fh.className='floating-heart';
        fh.textContent='❤️';
        fh.style.left=rect.left+'px';
        fh.style.top=rect.top+'px';
        document.body.appendChild(fh);

        let startTime=null;
        const duration=2000;
        const startX=rect.left, startY=rect.top, endX=topRect.left, endY=topRect.top;

        function animateHeart(time){
            if(!startTime) startTime=time;
            const elapsed=time-startTime;
            const t=Math.min(elapsed/duration,1);
            const currentX = startX + (endX-startX)*t + Math.sin(t*6*Math.PI)*15;
            const currentY = startY + (endY-startY)*t + Math.sin(t*4*Math.PI)*10;
            fh.style.left=currentX+'px';
            fh.style.top=currentY+'px';
            fh.style.transform=`scale(${1+0.2*t}) rotate(${t*360}deg)`;
            if(t<1) requestAnimationFrame(animateHeart);
            else{ topHeart.classList.add('liked'); setTimeout(()=>topHeart.classList.remove('liked'),1500); fh.remove();}
        }
        requestAnimationFrame(animateHeart);
    } else {
        likedProducts = likedProducts.filter(p=>p.id!==id);
        firebase.database().ref('likes/'+id).remove();
    }
    renderShop(posts);
}

function openShop(){ document.getElementById('overlay').style.display='flex'; renderShop(posts);}
function closeOverlay(){ document.getElementById('overlay').style.display='none';}
function showLikedProducts(){ renderShop(likedProducts); document.getElementById('overlay').style.display='flex';}

/* AI Chat Overlay */
function openAI(){ document.getElementById('aiOverlay').style.display='flex'; document.getElementById('aiMessages').innerHTML=''; }
function closeAI(){ document.getElementById('aiOverlay').style.display='none'; }
async function sendAIMessage(){
    const input=document.getElementById('aiInput');
    const msg=input.value.trim(); if(!msg) return;
    input.value="";
    const messages=document.getElementById('aiMessages');
    const userMsg=document.createElement('div'); userMsg.textContent=msg; userMsg.style.margin='10px'; userMsg.style.textAlign='right'; messages.appendChild(userMsg);

    // OpenRouter API call
    const res=await fetch('https://openrouter.ai/api/v1/chat/completions',{
        method:'POST',
        headers:{
            'Content-Type':'application/json',
            'Authorization':'Bearer sk-xxxxxxxxxxxx' // Your API key
        },
        body:JSON.stringify({model:'gpt-4o-mini',messages:[{role:'user',content:msg}]})
    });
    const data=await res.json();
    const reply=data.choices[0].message.content;
    const botMsg=document.createElement('div'); botMsg.textContent=reply; botMsg.style.margin='10px'; botMsg.style.textAlign='left'; messages.appendChild(botMsg);
    messages.scrollTop=messages.scrollHeight;
}

/* Bottom buttons placeholders */
function callNumber(){ window.location.href="tel:+919434274060"; }
function whatsappMessage(){ window.open("https://wa.me/919476091829?text=Hey!","_blank"); }
function openInstagram(){ window.open("https://instagram.com/youraccount","_blank"); }
function sendEmail(){ window.location.href="mailto:pjcompanyofficial@gmail.com"; }
function sendOrder(id){ const p=posts.find(x=>x.id===id); const msg=encodeURIComponent(`I am interested in this product:\nName: ${p.name}\nPrice: ₹${p.price}\nDescription: ${p.desc}`); window.open("https://wa.me/919476091829?text="+msg,"_blank"); }
</script>
</body>
</html>
